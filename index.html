<!doctype html>
<html lang="pt-BR">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Sistema RIDS</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
    }

    html {
      height: 100%;
    }

    .login-container {
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      width: 90%;
      max-width: 440px;
      padding: 48px 40px;
      position: relative;
      overflow: hidden;
    }

    .login-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, #ff6b35 0%, #f7931e 100%);
    }

    .logo-section {
      text-align: center;
      margin-bottom: 32px;
    }

    .logo-circle {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 16px;
      box-shadow: 0 4px 12px rgba(30, 60, 114, 0.3);
    }

    .logo-text {
      color: #ffffff;
      font-size: 32px;
      font-weight: bold;
      letter-spacing: 2px;
    }

    .page-title {
      color: #1e3c72;
      font-size: 28px;
      font-weight: 700;
      margin: 0 0 8px 0;
      text-align: center;
    }

    .welcome-text {
      color: #2a5298;
      font-size: 18px;
      font-weight: 500;
      margin: 0 0 4px 0;
      text-align: center;
    }

    .subtitle {
      color: #666666;
      font-size: 14px;
      margin: 0 0 32px 0;
      text-align: center;
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-label {
      display: block;
      color: #333333;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 15px;
      transition: all 0.3s ease;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .form-input:focus {
      outline: none;
      border-color: #2a5298;
      box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
    }

    .form-input::placeholder {
      color: #999999;
    }

    .remember-forgot {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      font-size: 14px;
    }

    .remember-me {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #666666;
      cursor: pointer;
    }

    .remember-me input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: #2a5298;
    }

    .forgot-link {
      color: #2a5298;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    .forgot-link:hover {
      color: #1e3c72;
      text-decoration: underline;
    }

    .login-button {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
      color: #ffffff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
    }

    .login-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255, 107, 53, 0.4);
    }

    .login-button:active {
      transform: translateY(0);
    }

    .register-section {
      text-align: center;
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #e0e0e0;
    }

    .register-text {
      color: #666666;
      font-size: 14px;
      margin: 0;
    }

    .register-link {
      color: #ff6b35;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s ease;
    }

    .register-link:hover {
      color: #f7931e;
      text-decoration: underline;
    }

    .footer-text {
      text-align: center;
      color: #999999;
      font-size: 13px;
      margin-top: 32px;
    }



    @media (max-width: 480px) {
      .login-container {
        padding: 32px 24px;
      }

      .page-title {
        font-size: 24px;
      }

      .welcome-text {
        font-size: 16px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="login-container">
   <div class="logo-section">
    <div class="logo-circle"><span class="logo-text">JD</span>
    </div>
    <h1 class="page-title" id="pageTitle">Sistema RIDS</h1>
    <p class="welcome-text" id="welcomeText">Bem-vindo ao Sistema</p>
    <p class="subtitle" id="subtitle">Relatório de Incidentes e Desvios</p>
   </div><!-- Login Form -->
   <form id="loginForm" class="form-container">
    <div class="form-group"><label for="email" class="form-label">E-mail</label> <input type="email" id="email" class="form-input" placeholder="seu.email@jdemito.com.br" required>
    </div>
    <div class="form-group"><label for="password" class="form-label">Senha</label> <input type="password" id="password" class="form-input" placeholder="Digite sua senha" required>
    </div>
    <div class="remember-forgot"><label class="remember-me"> <input type="checkbox" id="rememberMe"> <span>Lembrar-me</span> </label> <a href="#" class="forgot-link" id="forgotLink">Esqueceu a senha?</a>
    </div><button type="submit" class="login-button" id="loginButton">Entrar</button>
   </form><!-- Register Form -->
   <form id="registerForm" class="form-container" style="display: none;">
    <div class="form-group"><label for="fullName" class="form-label">Nome Completo</label> <input type="text" id="fullName" class="form-input" placeholder="Digite seu nome completo" required>
    </div>
    <div class="form-group"><label for="cpf" class="form-label">CPF</label> <input type="text" id="cpf" class="form-input" placeholder="000.000.000-00" maxlength="14" required>
    </div>
    <div class="form-group"><label for="registerEmail" class="form-label">E-mail</label> <input type="email" id="registerEmail" class="form-input" placeholder="seu.email@jdemito.com.br" required>
    </div>
    <div class="form-group"><label for="registerPassword" class="form-label">Senha</label> <input type="password" id="registerPassword" class="form-input" placeholder="Digite sua senha" required>
    </div>
    <div class="form-group"><label for="confirmPassword" class="form-label">Confirmar Senha</label> <input type="password" id="confirmPassword" class="form-input" placeholder="Confirme sua senha" required>
    </div><button type="submit" class="login-button" id="registerButton">Cadastrar</button>
   </form>
   <div class="register-section">
    <p class="register-text" id="switchText">Não tem uma conta? <a href="#" class="register-link" id="switchLink">Cadastre-se</a></p>
   </div>
   <p class="footer-text" id="footerText">© 2024 Grupo J Demito. Todos os direitos reservados.</p>
  </div>
  <script>
    const defaultConfig = {
      page_title: "Sistema RIDS",
      welcome_text: "Bem-vindo ao Sistema",
      subtitle: "Relatório de Incidentes e Desvios",
      login_button: "Entrar",
      footer_text: "© 2024 Grupo J Demito. Todos os direitos reservados.",
      primary_color: "#2a5298",
      accent_color: "#ff6b35",
      background_color: "#1e3c72",
      text_color: "#333333",
      surface_color: "#ffffff",
      font_family: "Segoe UI",
      font_size: 16
    };

    async function onConfigChange(config) {
      const pageTitle = document.getElementById('pageTitle');
      const welcomeText = document.getElementById('welcomeText');
      const subtitle = document.getElementById('subtitle');
      const loginButton = document.getElementById('loginButton');
      const footerText = document.getElementById('footerText');

      if (pageTitle) pageTitle.textContent = config.page_title || defaultConfig.page_title;
      if (welcomeText) welcomeText.textContent = config.welcome_text || defaultConfig.welcome_text;
      if (subtitle) subtitle.textContent = config.subtitle || defaultConfig.subtitle;
      if (loginButton) loginButton.textContent = config.login_button || defaultConfig.login_button;
      if (footerText) footerText.textContent = config.footer_text || defaultConfig.footer_text;

      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;
      const backgroundColor = config.background_color || defaultConfig.background_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;

      document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${primaryColor} 100%)`;
      
      const logoCircle = document.querySelector('.logo-circle');
      if (logoCircle) {
        logoCircle.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${primaryColor} 100%)`;
      }

      if (pageTitle) pageTitle.style.color = backgroundColor;
      if (welcomeText) welcomeText.style.color = primaryColor;

      const loginBtn = document.getElementById('loginButton');
      if (loginBtn) {
        loginBtn.style.background = `linear-gradient(135deg, ${accentColor} 0%, #f7931e 100%)`;
      }

      const inputs = document.querySelectorAll('.form-input');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.style.borderColor = primaryColor;
          this.style.boxShadow = `0 0 0 3px ${primaryColor}33`;
        });
      });

      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'Tahoma, Geneva, Verdana, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;

      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
      if (pageTitle) pageTitle.style.fontSize = `${baseSize * 1.75}px`;
      if (welcomeText) welcomeText.style.fontSize = `${baseSize * 1.125}px`;
      if (subtitle) subtitle.style.fontSize = `${baseSize * 0.875}px`;
      if (loginButton) loginButton.style.fontSize = `${baseSize}px`;
      if (footerText) footerText.style.fontSize = `${baseSize * 0.8125}px`;

      const labels = document.querySelectorAll('.form-label');
      labels.forEach(label => {
        label.style.fontSize = `${baseSize * 0.875}px`;
      });

      const formInputs = document.querySelectorAll('.form-input');
      formInputs.forEach(input => {
        input.style.fontSize = `${baseSize * 0.9375}px`;
      });
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.background_color || defaultConfig.background_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ background_color: value });
              }
            }
          },
          {
            get: () => config.surface_color || defaultConfig.surface_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ surface_color: value });
              }
            }
          },
          {
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ text_color: value });
              }
            }
          },
          {
            get: () => config.primary_color || defaultConfig.primary_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ primary_color: value });
              }
            }
          },
          {
            get: () => config.accent_color || defaultConfig.accent_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ accent_color: value });
              }
            }
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => config.font_family || defaultConfig.font_family,
          set: (value) => {
            if (window.elementSdk) {
              window.elementSdk.setConfig({ font_family: value });
            }
          }
        },
        fontSizeable: {
          get: () => config.font_size || defaultConfig.font_size,
          set: (value) => {
            if (window.elementSdk) {
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["page_title", config.page_title || defaultConfig.page_title],
        ["welcome_text", config.welcome_text || defaultConfig.welcome_text],
        ["subtitle", config.subtitle || defaultConfig.subtitle],
        ["login_button", config.login_button || defaultConfig.login_button],
        ["footer_text", config.footer_text || defaultConfig.footer_text]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }

    // Store registered users (in real app, this would be in a database)
    let registeredUsers = [];

    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      
      if (email && password) {
        const button = document.getElementById('loginButton');
        const originalText = button.textContent;
        button.textContent = 'Entrando...';
        button.disabled = true;
        
        setTimeout(() => {
          button.textContent = originalText;
          button.disabled = false;
          
          // Find user in registered users
          const user = registeredUsers.find(u => u.email === email);
          
          if (user && user.isAdmin) {
            // Admin login - redirect to admin panel
            const successDiv = document.createElement('div');
            successDiv.style.cssText = 'background: #e8f5e8; border: 1px solid #4caf50; color: #2e7d32; padding: 12px; border-radius: 8px; margin-top: 16px; text-align: center; font-size: 14px;';
            successDiv.innerHTML = '<strong>Login Administrativo!</strong><br>Abrindo painel administrativo...';
            successDiv.className = 'success-message';
            
            document.getElementById('loginForm').appendChild(successDiv);
            
            setTimeout(() => {
              successDiv.remove();
              redirectToAdminPanel();
            }, 1500);
          } else if (user) {
            // Regular user login
            const successDiv = document.createElement('div');
            successDiv.style.cssText = 'background: #efe; border: 1px solid #cfc; color: #363; padding: 12px; border-radius: 8px; margin-top: 16px; text-align: center; font-size: 14px;';
            successDiv.textContent = 'Login realizado com sucesso!';
            successDiv.className = 'success-message';
            
            document.getElementById('loginForm').appendChild(successDiv);
            
            setTimeout(() => {
              successDiv.remove();
            }, 2000);
          } else {
            // User not found or wrong credentials
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'background: #fee; border: 1px solid #fcc; color: #c33; padding: 12px; border-radius: 8px; margin-top: 16px; text-align: center; font-size: 14px;';
            errorDiv.textContent = 'E-mail ou senha incorretos.';
            errorDiv.className = 'error-message';
            
            document.getElementById('loginForm').appendChild(errorDiv);
            
            setTimeout(() => {
              errorDiv.remove();
            }, 3000);
          }
          
          document.getElementById('email').value = '';
          document.getElementById('password').value = '';
        }, 1500);
      }
    });

    document.getElementById('forgotLink').addEventListener('click', function(e) {
      e.preventDefault();
    });

    let isLoginMode = true;

    function toggleForms() {
      const loginForm = document.getElementById('loginForm');
      const registerForm = document.getElementById('registerForm');
      const switchText = document.getElementById('switchText');
      const switchLink = document.getElementById('switchLink');
      const pageTitle = document.getElementById('pageTitle');
      const welcomeText = document.getElementById('welcomeText');

      if (isLoginMode) {
        // Switch to register mode
        loginForm.style.display = 'none';
        registerForm.style.display = 'block';
        switchText.innerHTML = 'Já tem uma conta? <a href="#" class="register-link" id="switchLink">Fazer Login</a>';
        pageTitle.textContent = 'Cadastro RIDS';
        welcomeText.textContent = 'Criar Nova Conta';
        isLoginMode = false;
      } else {
        // Switch to login mode
        loginForm.style.display = 'block';
        registerForm.style.display = 'none';
        switchText.innerHTML = 'Não tem uma conta? <a href="#" class="register-link" id="switchLink">Cadastre-se</a>';
        pageTitle.textContent = 'Sistema RIDS';
        welcomeText.textContent = 'Bem-vindo ao Sistema';
        isLoginMode = true;
      }

      // Re-attach event listener to new link
      document.getElementById('switchLink').addEventListener('click', function(e) {
        e.preventDefault();
        toggleForms();
      });
    }

    document.getElementById('switchLink').addEventListener('click', function(e) {
      e.preventDefault();
      toggleForms();
    });

    // CPF formatting
    document.getElementById('cpf').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      value = value.replace(/(\d{3})(\d)/, '$1.$2');
      value = value.replace(/(\d{3})(\d)/, '$1.$2');
      value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
      e.target.value = value;
    });

    // Admin CPFs list
    const adminCPFs = [
      '043.718.592-04', '158.304.670-59', '629.450.881-12', '294.871.036-27',
      '780.215.349-80', '512.093.764-41', '337.660.125-96', '861.472.509-33',
      '405.239.618-07', '977.130.442-25', '206.548.390-66', '644.821.057-14',
      '053.997.281-09', '718.304.656-50', '380.165.924-78', '499.002.317-61',
      '882.416.503-38', '270.539.184-92', '591.740.826-03', '104.683.759-47'
    ];

    function isAdminCPF(cpf) {
      return adminCPFs.includes(cpf);
    }

    function redirectToAdminPanel() {
      window.location.href = 'https://sistemarid.github.io/gest-o/';
    }

    // Register form submission
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const fullName = document.getElementById('fullName').value;
      const cpf = document.getElementById('cpf').value;
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      if (password !== confirmPassword) {
        // Create temporary error message
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = 'background: #fee; border: 1px solid #fcc; color: #c33; padding: 12px; border-radius: 8px; margin-top: 16px; text-align: center; font-size: 14px;';
        errorDiv.textContent = 'As senhas não coincidem. Tente novamente.';
        
        const existingError = document.querySelector('.error-message');
        if (existingError) existingError.remove();
        
        errorDiv.className = 'error-message';
        document.getElementById('registerForm').appendChild(errorDiv);
        
        setTimeout(() => errorDiv.remove(), 3000);
        return;
      }
      
      if (fullName && cpf && email && password) {
        const button = document.getElementById('registerButton');
        const originalText = button.textContent;
        button.textContent = 'Cadastrando...';
        button.disabled = true;
        
        setTimeout(() => {
          button.textContent = originalText;
          button.disabled = false;
          
          // Check if admin CPF and store user
          const isAdmin = isAdminCPF(cpf);
          
          // Add user to registered users array
          registeredUsers.push({
            fullName: fullName,
            cpf: cpf,
            email: email,
            password: password,
            isAdmin: isAdmin
          });
          
          if (isAdmin) {
            // Success message for admin
            const successDiv = document.createElement('div');
            successDiv.style.cssText = 'background: #e8f5e8; border: 1px solid #4caf50; color: #2e7d32; padding: 12px; border-radius: 8px; margin-top: 16px; text-align: center; font-size: 14px;';
            successDiv.innerHTML = '<strong>Administrador cadastrado!</strong><br>Retornando ao login...';
            successDiv.className = 'success-message';
            
            document.getElementById('registerForm').appendChild(successDiv);
            
            setTimeout(() => {
              successDiv.remove();
              toggleForms(); // Switch back to login
            }, 2000);
          } else {
            // Success message for regular user
            const successDiv = document.createElement('div');
            successDiv.style.cssText = 'background: #efe; border: 1px solid #cfc; color: #363; padding: 12px; border-radius: 8px; margin-top: 16px; text-align: center; font-size: 14px;';
            successDiv.textContent = 'Funcionário cadastrado com sucesso! Retornando ao login...';
            successDiv.className = 'success-message';
            
            document.getElementById('registerForm').appendChild(successDiv);
            
            setTimeout(() => {
              successDiv.remove();
              toggleForms(); // Switch back to login
            }, 2000);
          }
          
          // Clear form
          document.getElementById('registerForm').reset();
        }, 1500);
      }
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'999f54e0a3b0f16d',t:'MTc2MjM3Njk2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>